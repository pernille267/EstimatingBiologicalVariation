% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{bv_anova}
\alias{bv_anova}
\title{Nested ANOVA for Biological Variation Data}
\usage{
bv_anova(data, cv_anova = FALSE)
}
\arguments{
\item{data}{A \code{list} (or \code{data.table}) with the
following columns or elements, each of equal length:
\describe{
  \item{\code{SubjectID}}{\code{integer} vector.
    Identifies the individual or participant.}
  \item{\code{SampleID}}{\code{integer} vector.
    Identifies the specimen collected from a subject.}
  \item{\code{ReplicateID}}{\code{integer} vector.
    Identifies the replicate measurement within a
    sample.}
  \item{\code{y}}{\code{numeric} vector. The measured
    analyte values.  \code{NA} values are silently
    excluded.}
}}

\item{cv_anova}{\code{logical}.  When \code{TRUE}, each
subject's measurements are divided by that subject's
mean before fitting the ANOVA, yielding a CV-ANOVA
whose variance components estimate coefficients of
variation directly.  Default is \code{FALSE}.}
}
\value{
A named \code{list} with:
  \describe{
    \item{\code{beta}}{Grand mean (\eqn{\mu}).}
    \item{\code{S1U_squared}}{Unweighted mean square
      between subjects.}
    \item{\code{S2U_squared}}{Unweighted mean square
      between samples within subjects.}
    \item{\code{S3_squared}}{Mean square within samples
      (analytical / residual).}
    \item{\code{n1}}{Degrees of freedom: between
      subjects (\eqn{I - 1}).}
    \item{\code{n2}}{Degrees of freedom: between
      samples within subjects
      (\eqn{\sum_i J_i - I}).}
    \item{\code{n3}}{Degrees of freedom: within
      samples (\eqn{N - \sum_i J_i}).}
    \item{\code{w1U, w2U, w3U}}{Weighting coefficients
      for the unweighted sums of squares.}
    \item{\code{sigma_i}}{\code{numeric} vector of
      per-subject within-subject SD estimates.}
    \item{\code{sigma_a}}{\code{numeric} vector of
      per-subject analytical SD estimates.}
    \item{\code{HBHR}}{Harris-Brown Heterogeneity Ratio (\%).}
  }
}
\description{
Fits one-way (per-subject) and two-way (overall) nested
random-effects ANOVA models to biological variation data.
Decomposes total variance into between-subject,
within-subject, and analytical (residual) components
using unweighted sums of squares.
}
\details{
The three-level nested random-effects model is:

\deqn{y_{isr} = \mu + G_i + I_{is} + A_{isr}}

where
\itemize{
  \item \eqn{G_i \sim N(0,\, \sigma_G^2)} is the
    between-subject effect,
  \item \eqn{I_{is} \sim N(0,\, \sigma_I^2)} is the
    within-subject (between-sample) effect, and
  \item \eqn{A_{isr} \sim N(0,\, \sigma_A^2)} is the
    analytical (residual / replicate) error.
}

The function computes both weighted and unweighted sums
of squares and returns the weighting coefficients
\eqn{w_{1U}}, \eqn{w_{2U}}, and \eqn{w_{3U}} needed
to recover variance-component point estimates from the
unweighted mean squares.  It also provides per-subject
estimates of \eqn{\sigma_I} and \eqn{\sigma_A}, which
are used to compute the Heterogeneity of Biological
Homeostatic Ratio (HBHR).
}
\examples{
\dontrun{
dat       <- simulate_bv_data(
  15, 10, 2, 10, 2, 50, 100
)
anova_fit <- bv_anova(dat)
anova_fit$beta        # grand mean
anova_fit$S3_squared  # analytical mean square
}

}
\seealso{
\code{\link{variance_components}} for
  extracting point estimates and confidence intervals;
  \code{\link{bv_anova_bootstrap_ci}} for bootstrap
  confidence intervals.
}
