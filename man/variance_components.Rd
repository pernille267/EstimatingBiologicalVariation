% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{variance_components}
\alias{variance_components}
\title{Variance-Component Point Estimates and Confidence
Intervals}
\usage{
variance_components(
  data,
  output_type = "sigma",
  mult = 1,
  level = 0.95,
  cv_anova = FALSE
)
}
\arguments{
\item{data}{A \code{list} (or \code{data.frame})
passed to \code{\link{bv_anova}}.  Must contain
\code{SubjectID}, \code{SampleID},
\code{ReplicateID}, and \code{y}.}

\item{output_type}{\code{character} string selecting
the type of output.  One of:
\describe{
  \item{\code{"sigma"}}{Point-estimate SDs.}
  \item{\code{"cv"}}{Point-estimate CVs
    (SDs divided by the grand mean).}
  \item{\code{"sigma_ci"}}{SDs with
    \eqn{(1-\alpha)} confidence intervals.}
  \item{\code{"cv_ci"}}{CVs with
    \eqn{(1-\alpha)} confidence intervals.}
}
Default is \code{"sigma"}.}

\item{mult}{\code{numeric} scaling factor applied to
every estimate and CI bound.  For example, use
\code{mult = 100} to express CVs as percentages.
Default is \code{1}.}

\item{level}{\code{numeric} confidence level for CIs,
between 0 and 1.  Ignored when \code{output_type}
is \code{"sigma"} or \code{"cv"}.
Default is \code{0.95}.}

\item{cv_anova}{\code{logical}.  When \code{TRUE},
the underlying ANOVA is run on subject-mean-scaled
values (CV-ANOVA).  Default is \code{FALSE}.}
}
\value{
A named \code{list} with:
  \describe{
    \item{\code{sigma_A}}{Analytical SD (or CV).
      Scalar or length-3 vector depending on
      \code{output_type}.}
    \item{\code{sigma_I}}{Within-subject SD
      (or CV).  Same structure as above.}
    \item{\code{sigma_G}}{Between-subject SD
      (or CV).  Same structure as above.}
    \item{\code{sigma_i}}{\code{numeric} vector
      of per-subject within-subject SD (or CV)
      estimates.}
    \item{\code{sigma_a}}{\code{numeric} vector
      of per-subject analytical SD (or CV)
      estimates.}
    \item{\code{HBHR}}{Heterogeneity of Biological
      Homeostatic Ratio (\%).}
    \item{\code{beta}}{Grand mean
      (\eqn{\hat\mu}).}
  }
}
\description{
Extracts variance-component standard deviations
(or CVs) from a nested ANOVA fit, with optional
confidence intervals based on the generalised
inference approach of Burdick & Graybill (1992).
}
\details{
For \code{output_type = "sigma"} or \code{"cv"},
the function returns scalar point estimates of
\eqn{\sigma_A} (analytical), \eqn{\sigma_I}
(within-subject), and \eqn{\sigma_G}
(between-subject).

For \code{output_type = "sigma_ci"} or
\code{"cv_ci"}, each component is a length-3
\code{numeric} vector
\code{[estimate, lower, upper]}.  The CI for
\eqn{\sigma_A} uses a chi-squared pivot; CIs for
\eqn{\sigma_I} and \eqn{\sigma_G} follow the
generalised confidence-interval method using
approximate F-distribution pivots (Burdick &
Graybill, 1992).

Negative variance estimates are truncated to zero
before taking square roots.
}
\examples{
\dontrun{
dat <- simulate_bv_data(
  15, 10, 2, 10, 2, 50, 100
)
# Point-estimate SDs
variance_components(dat, "sigma")

# CVs (\%) with 95\% CIs
variance_components(
  dat, "cv_ci", mult = 100, level = 0.95
)
}

}
\references{
Burdick, R. K. and Graybill, F. A. (1992).
\emph{Confidence Intervals on Variance Components}.
Marcel Dekker, New York.
}
\seealso{
\code{\link{bv_anova}} for the underlying
  ANOVA fit; \code{\link{bv_anova_bootstrap_ci}} for
  non-parametric bootstrap CIs.
}
