% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_analysis.R
\name{compute_anova_estimates}
\alias{compute_anova_estimates}
\title{Compute Nested ANOVA Variance Component Estimates}
\usage{
compute_anova_estimates(data, log_transformed = FALSE, cv_anova = FALSE)
}
\arguments{
\item{data}{A \code{data.table} with columns
\code{y}, \code{SubjectID}, \code{SampleID},
\code{ReplicateID}.}

\item{log_transformed}{Logical.  If \code{TRUE} the
\code{y} values are assumed to be log-transformed and
CVs are derived via \code{\link{lognormal_sd_to_cv}}.}

\item{cv_anova}{Logical.  If \code{TRUE} and
\code{log_transformed} is \code{FALSE}, the CV-ANOVA
approach is used for CV_A and CV_I (CIs computed
directly on CVs).  Ignored when
\code{log_transformed = TRUE}.}
}
\value{
A named list with \code{cv_table},
  \code{anova_table}, and scalar estimates.
}
\description{
Computes CV estimates and Burdick--Graybill confidence
intervals from a nested (subjects / samples / replicates)
ANOVA design.  Three estimation paths are supported:
}
\details{
\describe{
  \item{Standard (default)}{
    \code{log_transformed = FALSE, cv_anova = FALSE}.
    CVs and CIs are obtained directly from
    \code{\link{variance_components}} with
    \code{output_type = "cv_ci"}.
  }
  \item{Log-transformed data}{
    \code{log_transformed = TRUE}.
    Variance components are estimated on the log scale
    via \code{output_type = "sigma_ci"}, then converted
    to identity-scale CVs (%) with
    \code{\link{lognormal_sd_to_cv}}.  The grand mean is
    back-transformed as \code{exp(beta_log)}.
    \code{cv_anova} is ignored (forced \code{FALSE}).
  }
  \item{CV-ANOVA (identity scale only)}{
    \code{log_transformed = FALSE, cv_anova = TRUE}.
    The ANOVA is run on subject-mean-scaled values so
    that CIs apply directly to CV_A and CV_I.
    Because scaling removes between-subject variation,
    CV_G and its CI are taken from the standard
    (non-CV-ANOVA) approach instead.
  }
}

Variance-component point estimates and
Burdick--Graybill confidence intervals are computed
by \code{\link{variance_components}}.  The ANOVA
table (df, SS, MS) is obtained from
\code{\link{bv_anova}}.
}
\keyword{internal}
