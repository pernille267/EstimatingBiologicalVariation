% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/biovar_ported.R
\name{plot_subject_specific_CVI}
\alias{plot_subject_specific_CVI}
\title{Plot Subject-Specific (Within Individual) CVs}
\usage{
plot_subject_specific_CVI(
  processed_output,
  data = NULL,
  color_by = NULL,
  shape_by = NULL,
  title = "Subject-Specific CVs with 95\% Credible Intervals",
  subtitle = NULL,
  against_concentration = FALSE,
  against_RCV = FALSE,
  log_RCV = FALSE
)
}
\arguments{
\item{processed_output}{A \code{list} object returned by
\code{process_stan_output}. The function specifically
uses the \code{Subject_Specific} data.table.}

\item{data}{An optional \code{data.frame} or \code{data.table} containing the
original input data. This is \strong{required} if you
want to use the \code{color_by} or \code{shape_by}
arguments, as it must contain the grouping columns.}

\item{color_by}{A \code{character} string specifying
the column name in \code{data} to use for coloring
the points (e.g., \code{"sex"}). Defaults to
\code{NULL} (no color grouping).}

\item{shape_by}{A \code{character} string specifying
the column name in \code{data} to use for shaping
the points (e.g., \code{"material"}). Defaults to
\code{NULL} (no shape grouping).}

\item{title}{A \code{character} string for the plot title. Defaults to a
standard title.}

\item{subtitle}{A \code{character} string for the plot subtitle. Can be used
to provide context like the analyte name.}

\item{against_concentration}{A \code{logical} value. If \code{TRUE},
estimated concentration values for the subjects are plotted against CVs
instead of subject-specific CV values plotted against subject IDs.}

\item{against_RCV}{A \code{logical} value. If \code{TRUE}, Reference Change
values (RCVs) are plotted against CVs instead of subject-specific CV
values plotted against subject IDs. If both \code{against_concentration}
and \code{against_RCV} are set to \code{TRUE}, \code{against_concentration}
wins.}

\item{log_RCV}{A \code{logical} value. If \code{TRUE}, RCVs are calculated
assuming data is log-transformed.}
}
\value{
A \code{ggplot} object, which can be further customized.
}
\description{
Creates a dot-and-whisker plot visualizing the 95% credible intervals for
the intra-individual CV (\code{CVI}) for each subject.
It includes reference lines for the population predictive
distribution and allows for flexible grouping by color
and shape.
}
\details{
The plot is designed for clear visual comparison of individual CVI estimates.
\itemize{
  \item \strong{Points and Error Bars:} The central
    point for each subject represents their median
    posterior CVI, and the horizontal bars represent
    the 95\% credible interval.
  \item \strong{Green Reference Band:} The shaded
    green area represents the 60\% prediction interval
    for a new subject's CVI (from the 20th to the 80th
    percentile). The solid green line is the median of
    this predictive distribution.
  \item \strong{Ordering:} Subjects are ordered from
    bottom to top by their median CVI.
}
}
