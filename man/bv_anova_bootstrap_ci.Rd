% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{bv_anova_bootstrap_ci}
\alias{bv_anova_bootstrap_ci}
\title{Bootstrap Confidence Intervals for ANOVA
Variance Components}
\usage{
bv_anova_bootstrap_ci(
  data_orig,
  B,
  level = 0.95,
  output_type_for_point_est = "sigma",
  mult = 1
)
}
\arguments{
\item{data_orig}{A \code{list} (or \code{data.table})
with the same structure required by
\code{\link{bv_anova}}:
\describe{
  \item{\code{SubjectID}}{\code{integer} vector
    of subject identifiers.}
  \item{\code{SampleID}}{\code{integer} vector
    of sample identifiers.}
  \item{\code{ReplicateID}}{\code{integer} vector
    of replicate identifiers.}
  \item{\code{y}}{\code{numeric} vector of
    measured values.}
}}

\item{B}{\code{integer}.  Number of bootstrap
replicates to draw.  Values of 1000--10 000 are
typical.}

\item{level}{\code{numeric} confidence level,
between 0 and 1.  Default is \code{0.95}.}

\item{output_type_for_point_est}{\code{character}.
Either \code{"sigma"} (default) to report SDs
or \code{"cv"} to report coefficients of
variation.}

\item{mult}{\code{numeric} scaling factor applied
to every estimate and CI bound (e.g. \code{100}
for percentages).  Default is \code{1}.}
}
\value{
A named \code{list} with two elements:
  \describe{
    \item{\code{point_estimates}}{A \code{list} of
      scalar point estimates from the original data:
      \code{sigma_A}, \code{sigma_I},
      \code{sigma_G}, \code{HBHR}, and
      \code{beta}.}
    \item{\code{conf_intervals}}{A \code{list} of
      length-2 \code{numeric} vectors
      \code{[lower, upper]} for each parameter:
      \code{sigma_A_CI}, \code{sigma_I_CI},
      \code{sigma_G_CI}, \code{HBHR_CI}, and
      \code{beta_CI}.}
  }
}
\description{
Estimates percentile bootstrap confidence intervals
for the variance-component standard deviations (or
CVs) obtained from \code{\link{variance_components}}.
Subjects are resampled with replacement; the sample
and replicate structure within each selected subject
is kept intact.
}
\details{
At each bootstrap iteration the function:
\enumerate{
  \item Draws \eqn{I} subjects with replacement
    from the unique subject IDs (where \eqn{I} is
    the number of unique subjects in
    \code{data_orig}).
  \item Assembles the full sample-by-replicate
    data for the resampled subjects, remapping
    subject IDs to \eqn{1, \ldots, I}.
  \item Calls \code{\link{variance_components}} on
    the bootstrap dataset.
}

Percentile CIs are taken as the \eqn{\alpha / 2}
and \eqn{1 - \alpha / 2} quantiles of the \eqn{B}
bootstrap estimates (using \code{type = 7}
quantile interpolation).  Iterations that fail or
produce \code{NA} are excluded from the quantile
calculation.
}
\examples{
\dontrun{
dat <- simulate_bv_data(
  15, 10, 2, 10, 2, 50, 100
)
set.seed(42)
boot_ci <- bv_anova_bootstrap_ci(
  dat, B = 2000, level = 0.95,
  output_type_for_point_est = "cv",
  mult = 100
)
boot_ci$point_estimates$sigma_A
boot_ci$conf_intervals$sigma_A_CI
}

}
\seealso{
\code{\link{variance_components}} for the
  parametric (Burdick--Graybill) CI approach;
  \code{\link{bv_anova}} for the underlying ANOVA.
}
